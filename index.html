<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Contactes</title>
  <script src="https://aframe.io/releases/1.3.0/aframe.min.js"></script>
  <script src="https://cdn.rawgit.com/donmccurdy/aframe-extras/v6.1.0/dist/aframe-extras.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/mind-ar@1.2.0/dist/mindar-image-aframe.prod.js"></script>
</head>

<body>
  <a-scene color-space="sRGB" cursor="rayOrigin: mouse" renderer="colorManagement: true, physicallyCorrectLights"
           vr-mode-ui="enabled: false">
    <a-sky color="#580F0F"></a-sky>

    <a-assets>
      <a-asset-item id="github" src="assets/models/github.glb"></a-asset-item>
      <a-asset-item id="linkedin" src="assets/models/linkedin.glb"></a-asset-item>
      <a-asset-item id="scena" src="assets/models/contactes.glb"></a-asset-item>
      <a-asset-item id="megumi" src="assets/models/megumi.glb"></a-asset-item>
    </a-assets>

    <a-camera position="0 0.5653 -1.58505" rotation="-19.6 180 0"
              look-controls="enabled: false" wasd-controls="enabled: false"></a-camera>

    <a-entity id="megumi-model" gltf-model="#megumi" position="0 0 -1.5" scale="1 1 1" class="clickable"></a-entity>
    <a-entity gltf-model="#scena"></a-entity>

    <!-- Humo visual con textura animada -->
    <a-plane id="smoke"
      src="https://cdn.aframe.io/basic-guide/textures/smoke.png"
      transparent="true"
      opacity="0.8"
      visible="false"
      scale="0 0 0"
      position="0 1 -1.5"
      rotation="-90 0 0"
      animation__scale="property: scale; from: 0 0 0; to: 3 3 3; dur: 600; easing: easeOutQuad"
      animation__fade="property: opacity; from: 0.8; to: 0; dur: 600; easing: easeInQuad">
    </a-plane>

    <a-entity id="social-boxes" visible="false">
      <a-entity id="linkedin-box" gltf-model="#linkedin"
        position="0.05 0 0" scale="0 0 0" rotation="0 180 0" class="clickable"
        animation__appear="property: scale; from: 0 0 0; to: 0.02 0.02 0.02; dur: 800; easing: easeOutElastic">
      </a-entity>

      <a-entity id="github-box" gltf-model="#github"
        position="-0.05 0 0" scale="0 0 0" rotation="0 180 0" class="clickable"
        animation__appear="property: scale; from: 0 0 0; to: 0.02 0.02 0.02; dur: 800; easing: easeOutElastic">
      </a-entity>
    </a-entity>
  </a-scene>

  <div id="ui-menu">
    <button id="next" class="arrow-btn">Començar</button>
  </div>
  <div id="back-menu">
    <button id="back" class="arrow-btn">◀ Go back</button>
  </div>

  <style>
    #ui-menu {
      position: fixed;
      bottom: 40px;
      left: 50%;
      transform: translateX(-50%);
      background: rgba(100, 90, 70, 0.7);
      border-radius: 40px;
      padding: 10px 25px;
      display: flex;
      align-items: center;
      gap: 15px;
      font-family: 'Poppins', sans-serif;
      color: white;
      font-size: 1.2rem;
      backdrop-filter: blur(8px);
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.25);
      z-index: 999;
    }

    #back-menu {
      position: fixed;
      top: 20px;
      left: 20px;
      background: rgba(100, 90, 70, 0.7);
      border-radius: 40px;
      padding: 10px 25px;
      display: flex;
      align-items: center;
      gap: 15px;
      font-family: 'Poppins', sans-serif;
      color: white;
      font-size: 1.2rem;
      backdrop-filter: blur(8px);
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.25);
      z-index: 999;
    }

    .arrow-btn {
      background: transparent;
      border: none;
      color: white;
      font-size: 1.4rem;
      cursor: pointer;
      transition: transform 0.2s ease;
    }

    .arrow-btn:hover {
      transform: scale(1.3);
    }
  </style>

  <script>
    document.getElementById('back').addEventListener('click', () => {
      window.location.href = "main.html";
    });

    const escenas = [
      { nombre: 'Tornar en rere', posicion: '-6.00052 3.92269 -13.12781', rotacion: '-14.9 90 0' },
      { nombre: 'Començar', posicion: '0 0.08019 -0.26409', rotacion: '-19.628388145591742 179.9998479605043 0' },
    ];
    const camera = document.querySelector('a-camera');
    const nextButton = document.getElementById('next');
    const uiMenu = document.getElementById('ui-menu');
    let indice = 0;

    function cambiarEscena(delta) {
      indice = (indice + delta + escenas.length) % escenas.length;
      const escena = escenas[indice];
      camera.setAttribute('animation__move', {
        property: 'position',
        to: escena.posicion,
        dur: 2000,
        easing: 'easeInOutQuad'
      });
      camera.setAttribute('animation__look', {
        property: 'rotation',
        to: escena.rotacion,
        dur: 2000,
        easing: 'easeInOutQuad'
      });
      uiMenu.style.display = 'none';
    }

    nextButton.addEventListener('click', () => cambiarEscena(1));

    const megumi = document.getElementById('megumi-model');
    const socialBoxes = document.getElementById('social-boxes');
    const linkedinBox = document.getElementById('linkedin-box');
    const githubBox = document.getElementById('github-box');
    const smoke = document.getElementById('smoke');

    megumi.addEventListener('click', () => {
      smoke.setAttribute('visible', true);
      setTimeout(() => {
        smoke.setAttribute('visible', false);
        socialBoxes.setAttribute('visible', true);
      }, 700);
    });

    linkedinBox.addEventListener('click', () => {
      window.open('https://www.linkedin.com', '_blank');
    });

    githubBox.addEventListener('click', () => {
      window.open('https://www.github.com', '_blank');
    });
  </script>
</body>
</html>
